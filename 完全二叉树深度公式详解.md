### **完全二叉树深度公式详解**

---

在计算机科学中，完全二叉树是一种重要的数据结构，其结点排列方式具有特殊规律。对于一个具有 \( n \) 个结点的完全二叉树，其深度 \( k \) 可以通过以下公式计算：

\[
k = \lfloor \log_2 n \rfloor + 1
\]

本文将从公式的推导过程开始，结合实例验证和图示说明，全面解析这一公式的意义及其适用性。

---

### **1. 什么是完全二叉树？**

#### **1.1 完全二叉树的定义**

完全二叉树是一种特殊的二叉树，其满足以下条件：
1. 除了最后一层，每一层都是满的。
2. 最后一层的所有结点靠左排列。

例如：
- **完全二叉树（结点数 \( n = 5 \)）：**
  ```
  Depth: 3
  Level 1:          o
  Level 2:        o   o
  Level 3:      o  o
  ```

#### **1.2 满二叉树的定义**

满二叉树是完全二叉树的一种特殊情况，其中每一层都是满的，即：
\[
n = 2^k - 1
\]
其中 \( k \) 是树的深度。例如：
- **满二叉树（结点数 \( n = 15 \)）：**
  ```
  Depth: 4
  Level 1:          o
  Level 2:        o   o
  Level 3:      o  o  o  o
  Level 4:    o o o o o o o o
  ```

---

### **2. 深度公式的推导**

#### **2.1 满二叉树的结点与深度关系**

对于深度为 \( k \) 的满二叉树，其结点数为：
\[
n = 2^k - 1
\]
反过来，已知结点数 \( n \)，可推导深度为：
\[
k = \log_2 (n + 1)
\]

#### **2.2 完全二叉树的结点范围**

对于深度为 \( k \) 的完全二叉树，其结点数 \( n \) 满足：
\[
2^{k-1} \leq n < 2^k
\]
- **左端点 \( 2^{k-1} \)**：表示深度为 \( k \) 的最小结点数（仅最后一层有一个结点）。
- **右端点 \( 2^k - 1 \)**：表示深度为 \( k \) 的最大结点数（满二叉树）。

#### **2.3 深度公式的推导**

由 \( 2^{k-1} \leq n < 2^k \)，取对数可得：
\[
k - 1 \leq \log_2 n < k
\]
其中 \( k \) 是整数，表示树的深度。因此：
\[
k = \lfloor \log_2 n \rfloor + 1
\]

---

### **3. 公式解析与实例验证**

公式：
\[
k = \lfloor \log_2 n \rfloor + 1
\]

#### **3.1 公式解析**
- **向下取整 \( \lfloor \log_2 n \rfloor \)：**表示 \( n \) 的二进制对数的整数部分，对应可以完全填满的层数。
- **加 1：**表示完全二叉树的实际深度可能包含部分未满的下一层。

#### **3.2 示例验证**

1. **示例1：满二叉树**
   - \( n = 15 \)
   - 深度公式：
     \[
     k = \lfloor \log_2 15 \rfloor + 1 = \lfloor 3.91 \rfloor + 1 = 4
     \]
   - 验证：这是深度为 4 的满二叉树。

2. **示例2：完全二叉树（非满）**
   - \( n = 10 \)
   - 满足：
     \[
     2^3 \leq 10 < 2^4
     \]
     因此深度为 4。
   - 深度公式：
     \[
     k = \lfloor \log_2 10 \rfloor + 1 = \lfloor 3.32 \rfloor + 1 = 4
     \]

3. **示例3：仅 1 个结点**
   - \( n = 1 \)
   - 满足：
     \[
     2^0 \leq 1 < 2^1
     \]
     因此深度为 1。
   - 深度公式：
     \[
     k = \lfloor \log_2 1 \rfloor + 1 = \lfloor 0 \rfloor + 1 = 1
     \]

---

### **4. 公式的适用范围**

公式 \( k = \lfloor \log_2 n \rfloor + 1 \) 适用于所有完全二叉树：
1. **满二叉树：**是完全二叉树的特殊情况。
2. **非满的完全二叉树：**最后一层不满但靠左排列。
3. **边界情况：**如只有一个结点的完全二叉树。

---

### **5. 可视化总结**

#### **示例1：满二叉树 \( n = 15 \)**
```
Depth: 4
Level 1:          o
Level 2:        o   o
Level 3:      o  o  o  o
Level 4:    o o o o o o o o
```

#### **示例2：完全二叉树 \( n = 10 \)**
```
Depth: 4
Level 1:          o
Level 2:        o   o
Level 3:      o  o  o  o
Level 4:    o o
```

#### **示例3：仅 1 个结点 \( n = 1 \)**
```
Depth: 1
Level 1:          o
```

---

### **6. 总结**

- **公式总结：**
  \[
  k = \lfloor \log_2 n \rfloor + 1
  \]
  利用对数函数快速计算完全二叉树的深度。

- **公式的意义：**
  该公式统一了满二叉树和非满完全二叉树的深度计算，避免了逐层遍历计算深度的复杂性。

- **应用场景：**
  - 在完全二叉树中快速计算深度。
  - 为基于完全二叉树的数据结构（如堆排序）提供理论支持。

通过上述详解，公式的推导、验证、适用性得到了全面展现。如果有进一步的问题，欢迎讨论！